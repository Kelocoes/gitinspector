<div id="repository_div">

  <div class="box">

    <div style="width: 20px; position: absolute">
      <div id="repository_label" class="git2 visible">
        Repository Map
      </div>
    </div>

    <div id="repository_tmp">
    </div>

    <div id="repository_box"
         style="display: flex; flex-direction: column; align-items: center">

      <svg id="repository_svg" width="1040" height="600">
      </svg>

    </div>
    <script>
      var authors = $authors;
      var tree = $tree;
      var ownerships = $ownerships;

      // d3.select("div#repository_tmp").html(JSON.stringify(authors) + "<br/>" +
      // 					   JSON.stringify(ownerships));

      var svg = d3.select("svg#repository_svg"),
          xsep = 200, dy = 25,
          width = parseInt(svg.attr("width")),
          height = tree.length*dy;
      svg.attr("height", height);

      var y = d3.scaleBand()
          .domain(tree)
          .range([20, height]);

      var gfiles = svg.append("g").attr("transform", "translate(0,0)");;
      tree.forEach(function (f) {
	  gfiles.append("text").attr("y", y(f)).attr("x", 10*(f.split('/').length-1))
	      .text(f.split('/').pop());
      });
      var gowns = svg.append("g").attr("transform", "translate(" + xsep + ",0)");
      Object.keys(ownerships).forEach(function (f) {
	  var x = 0;
	  ownerships[f].forEach(function (o) {
	      gowns.append("rect")
		  .attr("x", x).attr("y", y(f)-dy/2)
		  .attr("height", dy-10).attr("width", o.rows)
		  .attr("fill",authors[o.author]);
	      x += o.rows;
	  });
      });

      // Make the div hideable
      make_box_hideable("repository_label", "repository_box", "flex");
    </script>
  </div>
</div>
